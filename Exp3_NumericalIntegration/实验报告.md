# 实验三：数值积分实验报告

## 1. 实验目的
- 理解数值积分的基本原理
- 实现并比较矩形法和梯形法两种数值积分方法
- 分析不同积分方法的收敛性和精度
- 探究步长对数值积分精度的影响

## 2. 实验原理
### 2.1 问题描述
计算定积分：
$$
I = \int_{0}^1 \sqrt{1-x^2} d x
$$
该积分表示1/4圆的面积，其解析解为 $\frac{1}{4}\pi \approx 0.7853981633974483$。

### 2.2 数值方法
#### 2.2.1 矩形法（左矩形法）
将积分区间 $[a,b]$ 等分为 $N$ 个子区间，每个子区间长度为 $h=(b-a)/N$，用左端点函数值近似该子区间上的平均函数值：
$$
\int_a^b f(x)dx \approx h\sum_{k=0}^{N-1} f(x_k), \quad x_k = a + kh
$$

#### 2.2.2 梯形法
同样将积分区间等分为 $N$ 个子区间，但使用梯形面积近似每个子区间上的积分：
$$
\int_a^b f(x)dx \approx \frac{h}{2}[f(a) + 2\sum_{k=1}^{N-1}f(x_k) + f(b)]
$$

## 3. 实验结果
### 3.1 数值结果
（填写不同N值下的计算结果表格）
|  | 矩形法结果 | 矩形法相对误差 | 梯形法结果 | 梯形法相对误差 | 
| --- | --- | --- | --- | --- | 
| 10 | 0.765147 | 2.58% | 0.782623 | 0.35% | 
| 100 | 0.782623 | 0.35% | 0.785298 | 0.01% | 
| 1000 | 0.785298 | 0.01% | 0.785398 | 0.0001% | 
| 10000 | 0.785398 | 0.0001% | 0.785398 | 0.00001% | 




### 3.2 误差分析图
（插入误差-步长关系的对数图，并说明观察到的现象）
![image](https://github.com/user-attachments/assets/45f1a062-040b-413f-9b33-d50020609656)


## 4. 分析与讨论
### 4.1 收敛性分析
- 矩形法的收敛阶数：1。矩形法的误差与步长 h 成正比，因此收敛速度较慢。
- 梯形法的收敛阶数：2。梯形法的误差与步长 h 
2
  成正比，因此收敛速度更快。
- 两种方法收敛性的比较：梯形法的收敛速度明显优于矩形法，尤其是在较大的步长下，梯形法的误差更小。

### 4.2 精度分析
- 在相同N值下两种方法精度的比较
- 梯形法的精度始终高于矩形法。

- 影响精度的主要因素分析
- 主要因素是步长 h 的大小。较小的步长可以提高精度，但会增加计算量。度的主要因素分析
  
- 如何选择合适的N值以达到期望精度
- 根据所需的精度，可以选择适当的 N 值。例如，如果需要误差小于 0.01%，可以选择 N=100 或更高。

### 4.3 计算效率
- 计算时间随N的变化规律
- 计算时间与 N 成正比，较大的 N 会导致更长的计算时间。
  
- 精度和计算时间的权衡
- 较大的 N 可以提高精度，但会增加计算时间。因此需要根据实际需求平衡精度和计算时间。

## 5. 结论
梯形法的精度和收敛速度均优于矩形法。误差与步长 h 的关系对收敛性有重要影响。在相同的计算量下，梯形法能够达到更高的精度。
两种方法的优缺点：
矩形法：
优点：实现简单。
缺点：收敛速度慢，精度较低。
梯形法：
优点：收敛速度快，精度高。
缺点：实现稍复杂，但仍然易于理解。

## 6. 思考题
1. 为什么梯形法通常比矩形法更精确？
梯形法通过使用梯形面积来近似每个子区间，能够更好地拟合曲线，因此误差更小。而矩形法仅使用左端点的函数值，忽略了函数在子区间内的变化，导致误差较大。

2. 如果被积函数在积分区间内有奇点（如 $\int_0^1 \frac{1}{\sqrt{x}}dx$），这些方法是否仍然适用？为什么？
这些方法可能不适用，因为奇点会导致函数值趋于无穷大，使得数值积分的结果不准确。在这种情况下，需要使用特殊的数值积分方法，如高斯积分法或自适应积分法。

3. 如何改进这些方法以获得更高的精度？
增加子区间数量 N。使用更高阶的数值积分方法，如辛普森法或高斯积分法。使用自适应积分法，根据函数的变化动态调整子区间大小。

## 附录：代码实现
```python
# 在此粘贴关键代码片段
```
